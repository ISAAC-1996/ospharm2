---
title: "ospharm2"
output: github_document
---


# ospharm2

`ospharm2` est un package R destin√© √† **automatiser les requ√™tes SQL utilis√©es dans les √©tudes pharmaceutiques**.  
L‚Äôobjectif est de **faciliter les analyses r√©p√©t√©es** sans avoir √† r√©√©crire manuellement les requ√™tes SQL,  
ce qui permet de gagner du temps, de r√©duire les erreurs et de limiter la d√©pendance √† la ma√Ætrise du SQL.

---

## Installation

Pour installer la version de d√©veloppement depuis GitHub :

```r
# Si ce n‚Äôest pas encore fait
install.packages("devtools")

# Installer depuis GitHub
devtools::install_github("ISAAC-1996/ospharm2")
```

##------------------- pharma_complete_12() ----------------------------
La fonction `pharma_complete_12()` permet de r√©cup√©rer la liste des **pharmacies compl√®tes** sur les 12 mois d‚Äôune ann√©e donn√©e, ainsi que leur **chiffre d‚Äôaffaires total**.

Elle est utile pour exclure les structures incompl√®tes des analyses de performance.

#### Fonctionnement :

- Par d√©faut (`n = 0`), elle renvoie les donn√©es de l‚Äôann√©e pr√©c√©dente (ann√©e en cours - 1)
- `n = 1` ‚Üí ann√©e en cours - 2, etc. jusqu‚Äô√† `n = 2`
- Au-del√†, elle indique qu‚Äôil n‚Äôy a pas de donn√©es

#### Exemple d'utilsation:

```r
library(ospharm2)
# Pharmacies compl√®tes de l‚Äôann√©e pr√©c√©dente
pharma_complete_12()

# Pour l‚Äôann√©e N-2
pharma_complete_12(n = 1)
```
##----------------------- fr√©quentation journali√®re moyenne ------------------------

La fonction `frequentation_journaliere()` permet de calculer la **fr√©quentation moyenne par jour** d‚Äôune pharmacie donn√©e sur une p√©riode personnalis√©e.

Cette fr√©quentation est calcul√©e √† partir des donn√©es de `v_el_collect_ospharm`, en comptant les clients uniques par jour sur la p√©riode indiqu√©e.

#### Exemple d'utilisation :

```r
library(ospharm2)

# Fr√©quentation moyenne de la pharmacie 123456 entre janvier et avril 2024
frequentation_journaliere(n_auto = 123456, date_debut = 202401, date_fin = 202404)
```

##--------------------Exemple : informations sur les pharmacies -----------------------

La fonction `pharmacies_infos()` permet de r√©cup√©rer les **informations d√©taill√©es** des pharmacies,
avec ou sans filtrage par **groupement**.

Par d√©faut, elle renvoie **toutes les pharmacies actives**.  
Tu peux lui passer un identifiant de groupement pour filtrer.



#### Exemple d'utilisation :

```r
library(ospharm2)

# Toutes les pharmacies
pharmacies_infos()

# Pharmacies du groupement 164
pharma
```

##------------------------ honoraires de nouvelles missions -------------------------
La fonction `Honoraires_new_mission()` permet de g√©n√©rer un tableau synth√©tique des **honoraires B2** (nouvelles missions) r√©alis√©s par les pharmacies sur une p√©riode d√©finie.

Par d√©faut, la fonction renvoie les honoraires pour **toutes les pharmacies actives**.  
Si un identifiant de **groupement** est fourni, elle filtre les r√©sultats pour ne montrer que les pharmacies appartenant √† ce groupement.

#### üîé Points cl√©s :
- Les actes suivants sont **exclus** automatiquement : `'HD'`, `'HG'`, `'HC'`, `'HDA'`, `'HDE'`, `'HDR'`
- Le tableau est **pivot√©** : chaque ligne correspond √† une pharmacie et chaque colonne √† un type d‚Äôhonoraire
- Les volumes sont **agr√©g√©s** (total des actes r√©alis√©s)

#### üìò Exemple d'utilisation :

```r
library(ospharm2)

# Honoraires pour toutes les pharmacies entre janvier et avril 2024
Honoraires_new_mission(date_debut = 202401, date_fin = 202404)

# Honoraires pour les pharmacies du groupement 411
Honoraires_new_mission(groupement = 411, date_debut = 202401, date_fin = 202404)
```




